package avrms.socket.app;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.net.URI;
import java.net.URISyntaxException;
import java.nio.ByteBuffer;
import java.util.List;
import java.util.Timer;
import java.util.TimerTask;
import java.util.concurrent.ThreadFactory;

import org.java_websocket.client.WebSocketClient;
import org.java_websocket.drafts.Draft;
import org.java_websocket.drafts.Draft.CloseHandshakeType;
import org.java_websocket.drafts.Draft.HandshakeState;
import org.java_websocket.exceptions.InvalidDataException;
import org.java_websocket.exceptions.InvalidHandshakeException;
import org.java_websocket.framing.Framedata;
import org.java_websocket.handshake.ClientHandshake;
import org.java_websocket.handshake.ClientHandshakeBuilder;
import org.java_websocket.handshake.HandshakeBuilder;
import org.java_websocket.handshake.ServerHandshake;
import org.java_websocket.handshake.ServerHandshakeBuilder;

import avrms.socket.WebsocketClientEndpoint;
public class SocketApp {
	public static void main(String[] args) throws IOException, InterruptedException, URISyntaxException {

	
		Process proc = Runtime.getRuntime().exec("ping -c 3 www.google.com");
		final WebsocketClientEndpoint clientEndPoint = new WebsocketClientEndpoint(new URI("ws://localhost:8080/avrms/realtime/echo.do"));
		// add listener
		clientEndPoint.addMessageHandler(new WebsocketClientEndpoint.MessageHandler() {
			public void handleMessage(String message) {
				System.out.println(message);
			}
		});
		while(true){
			clientEndPoint.sendMessage("LOG:");
		}
		WebSocketClient wsc = new WebSocketClient(new URI("ws://localhost:8080/avrms/realtime/echo.do"), new Draft_17()) {
			
			@Override
			public List<Framedata> translateFrame(ByteBuffer arg0) throws InvalidDataException {
				// TODO Auto-generated method stub
				return null;
			}
			
			@Override
			public void reset() {
				// TODO Auto-generated method stub
				
			}
			
			@Override
			public HandshakeBuilder postProcessHandshakeResponseAsServer(ClientHandshake arg0, ServerHandshakeBuilder arg1)
					throws InvalidHandshakeException {
				// TODO Auto-generated method stub
				return null;
			}
			
			@Override
			public ClientHandshakeBuilder postProcessHandshakeRequestAsClient(ClientHandshakeBuilder arg0)
					throws InvalidHandshakeException {
				// TODO Auto-generated method stub
				return null;
			}
			
			@Override
			public CloseHandshakeType getCloseHandshakeType() {
				// TODO Auto-generated method stub
				return null;
			}
			
			@Override
			public List<Framedata> createFrames(String arg0, boolean arg1) {
				// TODO Auto-generated method stub
				return null;
			}
			
			@Override
			public List<Framedata> createFrames(ByteBuffer arg0, boolean arg1) {
				// TODO Auto-generated method stub
				return null;
			}
			
			@Override
			public ByteBuffer createBinaryFrame(Framedata arg0) {
				// TODO Auto-generated method stub
				return null;
			}
			
			@Override
			public Draft copyInstance() {
				// TODO Auto-generated method stub
				return null;
			}
			
			@Override
			public HandshakeState acceptHandshakeAsServer(ClientHandshake arg0) throws InvalidHandshakeException {
				// TODO Auto-generated method stub
				return null;
			}
			
			@Override
			public HandshakeState acceptHandshakeAsClient(ClientHandshake arg0, ServerHandshake arg1)
					throws InvalidHandshakeException {
				// TODO Auto-generated method stub
				return null;
			}
		}) {
			
			@Override
			public void onOpen(ServerHandshake arg0) {
				// TODO Auto-generated method stub
				
			}
			
			@Override
			public void onMessage(String arg0) {
				// TODO Auto-generated method stub
				
			}
			
			@Override
			public void onError(Exception arg0) {
				// TODO Auto-generated method stub
				
			}
			
			@Override
			public void onClose(int arg0, String arg1, boolean arg2) {
				// TODO Auto-generated method stub
				
			}
		};
//		BufferedReader reader =  new BufferedReader(new InputStreamReader(proc.getInputStream()));
//		String line = "";
//		try {
//			while((line = reader.readLine()) != null){
////				System.out.println(line);
//				
//				clientEndPoint.sendMessage("LOG:"+line);
//				System.out.println("sent to server");
////				System.out.println("LOG:"+line);
//			}
//		} catch (IOException e) {
//			// TODO Auto-generated catch block
//			e.printStackTrace();
//		}
//		proc.waitFor();
//		
	}
	public static void readOutPut(Process proc) throws IOException, InterruptedException, URISyntaxException{
		// Read the output
		// open websocket
		
		
		
		Thread.sleep(10000);
	}

}
